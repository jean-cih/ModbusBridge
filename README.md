# PyModbusClientTCP

## Обзор
Класс для работы с устройствами по протоколу Modbus TCP через TCP-интерфейс. Обеспечивает надежное соединение, чтение/запись данных и контроль выполнения операций.

## Информация
Класс для работы с устройствами по протоколам Modbus RTU/TCP через TCP-интерфейс. Обеспечивает надежное соединение, чтение/запись данных и контроль выполнения операций.

## Основные возможности
### Что такое протокол Modbus?

Modbus – открытый коммуникационный протокол, основанный на архитектуре ведущий-ведомый (Master-Slave). 

Широко применяется в промышленности для организации связи между электронными устройствами.

Может использоваться для передачи данных через последовательные линии связи или Ethernet.

- Modbus RTU – RS-485, RS-422, RS-232 (Один Master, 247 Slave)
- Modbus ASCII – RS-485, RS-422, RS-232 (Один Master, 247 Slave)
- Modbus TCP – Ethernet (Много Master, много Slave)

### Функциональность подключения
- Установка TCP-соединения с устройством Modbus
- Контроль успешности подключения
- Проверка активности установленного соединения
- Безопасное завершение связи с подтверждением

### Операции чтения данных
- Чтение целочисленных значений (int) из регистров
- Чтение чисел с плавающей точкой (float32)
- Подтверждение успешности операции чтения
- Обработка ошибок протокола Modbus

### Операции записи данных
- Запись целочисленных значений (int) в регистры
- Запись чисел с плавающей точкой (float32)
- Подтверждение успешности операции записи
- Контроль целостности передаваемых данных

## Методы класса

### Управление соединением
- **connect()** - установка соединения с устройством
- **is_connected()** - проверка активности соединения
- **disconnect()** - корректное завершение связи

### Методы чтения
- **read_int()** - чтение целого числа
- **read_float()** - чтение числа с плавающей точкой

### Методы записи
- **write_int()** - запись целого числа
- **write_float()** - запись числа с плавающей точкой

## Параметры методов

### Общие параметры для всех операций
- `slave_id` - идентификатор устройства Modbus
- `address` - адрес начального регистра
- `count` - количество регистров (по умолчанию: 2)

### Специфические параметры
- Для записи: `value_int` или `value_float` - значение для записи

## Особенности реализации

### Безопасность соединения
- Автоматическая проверка соединения перед каждой операцией
- Защита от выполнения операций при разорванном соединении
- Грамотная обработка сетевых ошибок

### Обработка данных
- Корректное преобразование типов данных
- Правильный порядок байт (big-endian для float)
- Контроль целостности передаваемых значений

### Обработка ошибок
- Перехват исключений ModbusException
- Детальное логирование ошибок
- Возврат статуса выполнения операций

## Последовательность работы

1. **Инициализация** - создание клиента с указанием хоста и порта
2. **Подключение** - установка соединения с контролем успешности
3. **Проверка связи** - подтверждение активности соединения
4. **Операции** - выполнение чтения/записи данных
5. **Завершение** - безопасное закрытие соединения

## Преимущества использования

- **Надежность** - контроль на каждом этапе работы
- **Удобство** - простой и понятный API
- **Безопасность** - защита от потери данных
- **Совместимость** - работа с различными устройствами Modbus
- **Диагностика** - подробное логирование ошибок

## Типичные сценарии использования

- Промышленная автоматизация
- Системы SCADA
- Сбор данных с датчиков
- Управление технологическим оборудованием
- Мониторинг энергопотребления

## Реальная тестовая система

Тестирование проводилось с использованием:

![photo_5382065429364734163_y](https://github.com/user-attachments/assets/0977876e-d87c-4d75-8cf4-7c011180a570)

- Датчик PT1000: Температурный датчик с сопротивлением 1 кОм при 0°C.
  ![photo_5379813629551048493_y](https://github.com/user-attachments/assets/cc7d8fcf-9553-48a1-83a7-2685329f515e)
- Модуль аналогового ввода: MB210-101.
  ![photo_5382065429364734162_y](https://github.com/user-attachments/assets/49e34e28-cfbc-4e4a-8d86-16a01c579748)
- Блок питания: БП30Б-Д3.
  ![photo_5379813629551048491_y](https://github.com/user-attachments/assets/2e91ad5d-8734-48fe-ad22-b2283a6ea90f)
- Ethernet-конвертер: USB-C2500 2.5G RJ45 Ethernet Adapter используется для связи между модулем аналогового ввода и компьютером.
- Компьютер: Соединение осуществляется через COM4 порт.
